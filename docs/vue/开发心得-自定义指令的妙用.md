# ä½¿ç”¨ vue è‡ªå®šä¹‰æŒ‡ä»¤ç»™æŒ‰é’®æ·»åŠ æƒé™æ§åˆ¶å¹¶ hover æç¤º  

## èƒŒæ™¯  

æœ€è¿‘æ¥åˆ°ä¸€ä¸ªéœ€æ±‚: åœæœä¹‹åä¸å…è®¸ç”¨æˆ·æ“ä½œéƒ¨åˆ†é¡µé¢çš„æŒ‰é’®, ç¦ç”¨å¹¶ hover æç¤º 'å·²åœæœ, æš‚ä¸æ”¯æŒæ“ä½œ'.  

æ‰“å¼€ç›¸å…³é¡µé¢ä¸€ç…, å¯¹ç€å¯†å¯†éº»éº»çš„æŒ‰é’®é™·å…¥äº†æ²‰æ€...

é‡å†™æ¯ä¸ªæŒ‰é’®? å°è£…ä¸€ä¸ªé«˜é˜¶ç»„ä»¶? ç¬é—´äº§ç”Ÿä¸€ç³»åˆ—æƒ³æ³•, ä½†éƒ½ä¸å¯é¿å…çš„è¦å»å¯¹æ¯ä¸€ä¸ªæŒ‰é’®è¿›è¡Œæ”¹é€ , æ—¢é‡å¤åˆæ²¡æœ‰è¥å…».  

æœ¬ç€è¿½æ±‚ä¼˜é›…(èƒ½å·æ‡’å°±å·æ‡’)çš„åŸåˆ™, æˆ‘æƒ³åˆ°äº† **vue çš„è‡ªå®šä¹‰æŒ‡ä»¤**, ç®€å•çš„åªéœ€è¦ä¸€å¥ä»£ç , ç®€å•ä¼˜é›…, èŠ‚çœä¸å°‘æ—¶é—´(å¢åŠ æ‘¸é±¼æ—¶é—´).  

## æ€è·¯  

1. ä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤æ‹¿åˆ°å½“å‰ ```el```, ç»™å½“å‰ ```el```æ·»åŠ ä¸€ä¸ª ```class``` å, å¦‚```directive-disabled```, è¯¥```class```ç”¨æ¥æä¾›ç¦ç”¨æ ·å¼  
2. ä½¿ç”¨ ```Vue.extend```æ„é€ ä¸€ä¸ª```tooltip```å­ç±», ç”¨äº hover æ—¶æç¤º  
3. å°†```tooltip```æ„é€ å­ç±»æ’å…¥åˆ°ä¹‹å‰æ‹¿åˆ°çš„```el```ä¸‹,ä½¿ç”¨ç»å¯¹å®šä½ä¿æŒè·Ÿ```el```ä¸€æ ·çš„å¤§å°å®ç° hover æ—¶æç¤ºåŠŸèƒ½  

## ä»£ç å¦‚ä¸‹  

1. å®šä¹‰è‡ªå®šä¹‰æŒ‡ä»¤, æ­ä¸ªæ¶å­, è¿™é‡Œä½¿ç”¨æ’ä»¶çš„å†™æ³•    

```js
// disabledStopService.js
const disabledStopService = {
    inserted: function(el, _binding, vnode) {
    },
};

const install = {
    install: function() {
        Vue.directive('disabledStopService', disabledStopService);
    },
};

export default install;  

// main.js  
Vue.use(disabledStopService);  // æ³¨æ„: éœ€æ”¾åœ¨å®ä¾‹åŒ– Vue ä¹‹å‰
```

2. é€šè¿‡```store```ä¸­å®šä¹‰çš„```getters```æ‹¿åˆ°åœæœçŠ¶æ€, è‹¥åœæœ, åˆ™ç»™å½“å‰```el```æ·»åŠ ```directive-disabled```ç±»å  

```js
const disabledStopService = {
    inserted: function(el: HTMLElement, _binding: any, vnode: any) {
        //  ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ‹¿åˆ° vue å®ä¾‹ä¸Šä¸‹æ–‡
        const getIsStopService = vnode.context.$store.getters.getIsStopService;

        if (getIsStopService) {
           el.classList.add('directive-disabled');
        }
    },
};
```

3. ä½¿ç”¨```vue.extend```æ„é€ ```tooltip```å­ç±», æä¾› hover æ—¶æ–‡æ¡ˆæç¤ºåŠŸèƒ½  

```js
const TootipCtor = Vue.extend({
  	// è¿™é‡Œä½¿ç”¨çš„æ˜¯ elementUi tooltip ç»„ä»¶, éœ€è¦æå‰å†™å¥½ç±»ådirective-hidden, æ–¹ä¾¿åé¢å†™æ ·å¼ä¿æŒè·Ÿä¹‹å‰çš„ el ä¸€æ ·å¤§å°, ä¸éœ€è¦å†…å®¹, ç›®çš„æ˜¯ä¸ºäº†æµ®åœ¨ el ä¸Š
    template: `<el-tooltip content="å½“å‰è´¦å·å·²åœæœï¼Œæ— æ³•æ“ä½œ" placement="top" >
            <div class="directive-hidden" />
        </el-tooltip>`,
})
```

4. å°†å­ç±»æ’å…¥åˆ°```el```ä¸­   

```js
const disabledStopService = {
    inserted: function(el, _binding, vnode) {
        const getIsStopService = vnode.context.$store.getters.getIsStopService;

        if (getIsStopService) {
            el.classList.add('directive-disabled');

            const instance = new TootipCtor();
            const instanceEl = instance.$mount().$el;

            el.appendChild(instanceEl);
        }
    },
};

```

5. æœ€åä¸€æ­¥éœ€è¦å°†ä½¿ç”¨åŸç”Ÿå±æ€§```disabled```å°†```button```ç½®ä½ç¦ç”¨æ€, é˜²æ­¢è§¦å‘ç‚¹å‡»äº‹ä»¶. å…¨éƒ¨ä»£ç å¦‚ä¸‹:  

```js
import Vue from 'vue';

const TootipCtor = Vue.extend({
    template: `<el-tooltip content="å½“å‰è´¦å·å·²åœæœï¼Œæ— æ³•æ“ä½œ" placement="top" >
            <div class="directive-hidden" />
        </el-tooltip>`,
});

const disabledStopService = {
    inserted: function(el, _binding, vnode) {
      	//  ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ‹¿åˆ° vue å®ä¾‹ä¸Šä¸‹æ–‡
        const getIsStopService = vnode.context.$store.getters.getIsStopService;

        if (getIsStopService) {
            setTimeout(() => {
              	// è¿™æ ·å¯ä»¥ä½¿ç”¨ elementUi é»˜è®¤ç¦ç”¨æ ·å¼ 
              	el.classList.add('is-disabled');
                el.classList.add('directive-disabled');
              	// é˜²æ­¢è§¦å‘ button ç‚¹å‡»äº‹ä»¶
                el.setAttribute('disabled', 'disabled');
            });

            const instance = new TootipCtor();
            const instanceEl = instance.$mount().$el;

            // å¢åŠ æŒ‡ä»¤çš„ä½¿ç”¨èŒƒå›´, ä¸å±€é™äº buttonä¸Š, å¦‚ a æ ‡ç­¾, icon, div ç­‰. é€šè¿‡é˜»æ­¢äº‹ä»¶å†’æ³¡çš„æ–¹æ³•å®ç°é˜»æ­¢äº‹ä»¶è§¦å‘
            instanceEl.addEventListener('click', e => {
                e.stopPropagation();
                e.cancelBubble = true;
            });
            el.appendChild(instanceEl);
        }
    },
};

const install = {
    install: function() {
        Vue.directive('disabledStopService', disabledStopService);
    },
};

export default install;  
```

æ ·å¼:  

```css
.directive-disabled {
    position: relative;
    cursor: not-allowed;
    opacity: 0.7;
    .directive-hidden {
        position: absolute;
        height: 100%;
        width: 100%;
        left: 0;
        top: 0;
        cursor: not-allowed;
    }
}
```



## æ€»ç»“  

ä¸€å¥è¯: åªè¦æ€æƒ³ä¸æ»‘å¡, æ–¹æ³•æ€»æ¯”å›°éš¾å¤š.  

ç”¨çš„éƒ½æ˜¯å¸¸è§„çš„æ–¹æ³•,  å®ç°ä¹Ÿä¸å¤æ‚, ç›¸ä¿¡èƒ½æƒ³åˆ°è¿™ä¸€ç‚¹çš„éƒ½èƒ½åšåˆ°.  

ä¿æŒå¥½å¥‡, ä¿æŒæ€è€ƒğŸ¤”  

è¦ä¼˜é›…~